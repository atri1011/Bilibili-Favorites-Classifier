# Bilibili 收藏夹分类脚本 - 全新UI/UX设计文档

## 1. 核心设计理念

将现有基于弹窗的功能，重构成一个以 **悬浮按钮 (Floating Action Button - FAB)** 为入口、**全程可视化** 的流畅交互体验。旨在提供一个直观、不打扰且功能强大的用户界面。

---

## 2. 悬浮按钮 (FAB) 设计

FAB是所有功能的唯一入口，设计遵循简洁、直观的原则。

*   **位置与外观**:
    *   **位置**: 固定于浏览器窗口右下角。
    *   **图标**: 默认状态为B站小电视📺 + 魔法棒🪄角标。
    *   **样式**: 半透明B站粉色调，减少视觉干扰。

*   **交互状态**:
    *   **默认状态**: 半透明，安静驻留。
    *   **悬停状态**: 完全不透明，轻微放大，并显示工具提示“启动收藏夹智能分类”。
    *   **点击行为**: 触发主面板滑出，同时FAB图标平滑过渡为“关闭”图标 `❌`。

*   **状态流转图**:
    ```mermaid
    graph TD
        A[<b>默认状态</b><br>半透明图标] -- 鼠标悬停 --> B{<b>悬停状态</b><br>不透明/放大/提示};
        B -- 鼠标移出 --> A;
        A -- 点击 --> C{<b>激活状态</b><br>主面板展开/图标变化};
        B -- 点击 --> C;
        C -- 点击"关闭" --> A;
    ```

---

## 3. 主面板布局设计

点击FAB后，从屏幕右侧滑出主面板（宽度约350px），布局遵循自上而下的引导式设计。

*   **区域划分**:
    1.  **顶部区域**: 标题、`⚙️` 设置入口 (内联展开)、`❓` 帮助入口。
        *   **设置面板**: 包含 `API Key` 输入框、**`AI模型` 下拉选择框** (含预设模型和 "custom" 选项)，以及一个当选择 "custom" 时才出现的 **自定义模型名称输入框**。
    2.  **中部区域**: 核心流程控制，分为三步。
        *   **步骤一: 选择源收藏夹**: 一个 **可多选的复选框列表**，展示用户的所有收藏夹。
        *   **步骤二: 选择目标收藏夹**: 同样是一个可多选的复选框列表。
        *   **步骤三: 启动**: "开始分类" 按钮。
    3.  **底部区域**: 状态与反馈，默认最小化，启动后展开。

*   **布局可视化**:
    ```mermaid
    graph TD
        subgraph 主面板
            direction TB
            A["<b>顶部</b><br>标题 / 设置⚙️(含API Key, AI模型) / 帮助❓"];
            B["<b>核心流程</b><br>① 多选源收藏夹<br>② 多选目标收藏夹<br>③ 启动分类"];
            C["<b>状态反馈</b><br>进度条 / 实时状态 / 日志 / 统计"];
            A --> B --> C;
        end
    ```

---

## 4. 核心交互流程

定义了从准备到完成的完整用户旅程。

*   **流程时序图**:
    ```mermaid
    sequenceDiagram
        participant User as 用户
        participant Panel as 主面板
        participant Classifier as 分类器
        
        User->>Panel: 1. 打开面板, 在设置中配置好API Key和AI模型
        User->>Panel: 2. 在列表中多选源和目标收藏夹
        User->>Panel: 3. 点击"开始分类"
        Panel->>Panel: 4. 禁用输入, UI进入"进行中"状态
        Panel->>Classifier: 5. 发送分类请求(包含视频列表、目标收藏夹、AI模型)
        loop 处理每个视频
            Classifier-->>Panel: 6. 返回处理状态
            Panel-->>User: 7. 实时更新UI(进度/日志)
        end
        Classifier-->>Panel: 8. 返回最终结果
        Panel-->>User: 9. 显示完成摘要, 恢复UI
    ```

---

## 5. 状态与反馈机制

通过视觉、文本和错误处理机制，提供全方位的用户沟通。

*   **视觉反馈**:
    *   **<write_to_file>
<path>bilibili-favorites-classifier-userscript/NEW_UI_DESIGN.md</path>
<content>
# Bilibili 收藏夹分类脚本 - 全新UI/UX设计文档

## 1. 核心设计理念

将现有基于弹窗的功能，重构成一个以 **悬浮按钮 (Floating Action Button - FAB)** 为入口、**全程可视化** 的流畅交互体验。旨在提供一个直观、不打扰且功能强大的用户界面。

---

## 2. 悬浮按钮 (FAB) 设计

FAB是所有功能的唯一入口，设计遵循简洁、直观的原则。

*   **位置与外观**:
    *   **位置**: 固定于浏览器窗口右下角。
    *   **图标**: 默认状态为B站小电视📺 + 魔法棒🪄角标。
    *   **样式**: 半透明B站粉色调，减少视觉干扰。

*   **交互状态**:
    *   **默认状态**: 半透明，安静驻留。
    *   **悬停状态**: 完全不透明，轻微放大，并显示工具提示“启动收藏夹智能分类”。
    *   **点击行为**: 触发主面板滑出，同时FAB图标平滑过渡为“关闭”图标 `❌`。

*   **状态流转图**:
    ```mermaid
    graph TD
        A[<b>默认状态</b><br>半透明图标] -- 鼠标悬停 --> B{<b>悬停状态</b><br>不透明/放大/提示};
        B -- 鼠标移出 --> A;
        A -- 点击 --> C{<b>激活状态</b><br>主面板展开/图标变化};
        B -- 点击 --> C;
        C -- 点击"关闭" --> A;
    ```

---

## 3. 主面板布局设计

点击FAB后，从屏幕右侧滑出主面板（宽度约350px），布局遵循自上而下的引导式设计。

*   **区域划分**:
    1.  **顶部区域**: 标题、`⚙️` 设置入口 (内联展开)、`❓` 帮助入口。
        *   **设置面板**: 包含 `API Key` 输入框、**`AI模型` 下拉选择框** (含预设模型和 "custom" 选项)，以及一个当选择 "custom" 时才出现的 **自定义模型名称输入框**。
    2.  **中部区域**: 核心流程控制，分为三步。
        *   **步骤一: 选择源收藏夹**: 一个 **可多选的复选框列表**，展示用户的所有收藏夹。
        *   **步骤二: 选择目标收藏夹**: 同样是一个可多选的复选框列表。
        *   **步骤三: 启动**: "开始分类" 按钮。
    3.  **底部区域**: 状态与反馈，默认最小化，启动后展开。

*   **布局可视化**:
    ```mermaid
    graph TD
        subgraph 主面板
            direction TB
            A["<b>顶部</b><br>标题 / 设置⚙️(含API Key, AI模型) / 帮助❓"];
            B["<b>核心流程</b><br>① 多选源收藏夹<br>② 多选目标收藏夹<br>③ 启动分类"];
            C["<b>状态反馈</b><br>进度条 / 实时状态 / 日志 / 统计"];
            A --> B --> C;
        end
    ```

---

## 4. 核心交互流程

定义了从准备到完成的完整用户旅程。

*   **流程时序图**:
    ```mermaid
    sequenceDiagram
        participant User as 用户
        participant Panel as 主面板
        participant Classifier as 分类器
        
        User->>Panel: 1. 打开面板, 在设置中配置好API Key和AI模型
        User->>Panel: 2. 在列表中多选源和目标收藏夹
        User->>Panel: 3. 点击"开始分类"
        Panel->>Panel: 4. 禁用输入, UI进入"进行中"状态
        Panel->>Classifier: 5. 发送分类请求(包含视频列表、目标收藏夹、AI模型)
        loop 处理每个视频
            Classifier-->>Panel: 6. 返回处理状态
            Panel-->>User: 7. 实时更新UI(进度/日志)
        end
        Classifier-->>Panel: 8. 返回最终结果
        Panel-->>User: 9. 显示完成摘要, 恢复UI
    ```

---

## 5. 状态与反馈机制

通过视觉、文本和错误处理机制，提供全方位的用户沟通。

*   **视觉反馈**:
    *   **加载中**: 使用旋转图标。
    *   **成功**: 使用绿色 `✓` 符号和高亮。
    *   **失败**: 使用红色 `❌` 符号和高亮。

*   **文本反馈**:
    *   提供清晰的空状态提示、引导性工具提示和具体的错误信息。

*   **错误处理**:
    *   **智能冷却**: 自动处理API频率限制，进行等待并提示用户。
    *   **容错性**: 单个视频处理失败不中断整体流程，仅记录日志。
    *   **会话恢复(进阶)**: 提供意外关闭页面后的任务恢复功能。

*   **反馈流程图**:
    ```mermaid
    graph TD
        subgraph "分类任务执行"
            A[启动] --> B{API请求};
            B -- 成功 --> C{处理视频};
            B -- 失败 --> D[提示: 网络/API错误];
            C -- 成功 --> E[日志: 成功✓];
            C -- 稿件失效 --> F[日志: 跳过✗];
            C -- API限流 --> G[自动冷却, 等待...];
        end